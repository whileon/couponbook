<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ê³µì£¼ë‹˜ ë””ì§€í„¸ ì¿ í°ë¶</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- ì—¬ê¸° icon.png ìë¦¬ì— ê³µì£¼â™¥/íŒŒíŠ¸ë¼ìŠˆ ì•„ì´ì½˜ íŒŒì¼ ë„£ìœ¼ë©´ í™ˆ í™”ë©´ ì•„ì´ì½˜ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥ -->
 <link rel="icon" type="image/png" 
href="https://ai.esmplus.com/whiletype/%EC%98%A4%EB%8B%89%EC%8A%A4%EC%8A%A4%ED%86%A0%EC%96%B4/icon.png" />
  <style>
/* ì „ì²´ ê¸°ë³¸ ê¸€ì ì‚´ì§ í‚¤ìš°ê¸° */
body {
  font-size: 18px; /* ê¸°ì¡´ë³´ë‹¤ ì•½ 10~12% ì¦ê°€ */
}

/* ì¿ í° ì œëª© (ì•/ë’¤ ê³µí†µ) */
.coupon-title {
  font-size: 1.35rem;   /* ì›ë˜ 1.0rem â†’ í¬ê²Œ */
  font-weight: 600;
  margin-bottom: 8px;
}

/* ì•ë©´/ë’·ë©´ ì§§ì€ ì„¤ëª… */
.coupon-sub {
  font-size: 1.05rem;   /* ì›ë˜ 0.8rem~1rem ë³´ë‹¤ ì—… */
  margin-bottom: 10px;
  line-height: 1.55;
}

/* ë’·ë©´ ë‚´ìš© íŠ¹ë³„íˆ ë” í‚¤ì›€ */
#back-sub {
  font-size: 1.12rem;   /* ë’·ë©´ë§Œ ë” í¬ê²Œ */
  line-height: 1.6;
}

/* ì‚¬ìš© ì •ë³´ â€œë‚¨ì€ ì¥ìˆ˜ / ë§ˆì§€ë§‰ ì‚¬ìš©ì¼â€ */
.used-info {
  font-size: 0.95rem;   /* ì›ë˜ë³´ë‹¤ ì—… */
}

/* ì¹©(ì´ ëª‡ ì¥ ì¤‘, íƒœê·¸) */
.chip {
  font-size: 0.9rem;    /* ê¸°ì¡´ 0.72rem â†’ ì—… */
  padding: 4px 10px;
}

/* ë²„íŠ¼ */
.btn {
  font-size: 0.85rem;
  padding: 8px 14px;
}

/* ì‘ì€ ë²„íŠ¼ë„ ì¡°ê¸ˆ í‚¤ì›€ */
.btn-small {
  font-size: 0.82rem;
  padding: 6px 12px;
}

/* íŒíŠ¸ ê¸€ì”¨ */
.hint {
  font-size: 0.8rem;    /* ì¡°ê¸ˆ ë” í¬ê²Œ */
}

/* ë„¤ë¹„ê²Œì´ì…˜ í…ìŠ¤íŠ¸ */
.nav-title {
  font-size: 0.88rem;
}

.nav-title span {
  font-size: 0.95rem;
}

/* í—¤ë” ìƒë‹¨ í…ìŠ¤íŠ¸ */
.title {
  font-size: 1rem;
}
.subtitle {
  font-size: 0.85rem;
}
.dday {
  font-size: 0.95rem;
}
.remain {
  font-size: 0.85rem;
}

    :root {
      --bg: #050508;
      --card-bg: #111117;
      --gold: #d4af37;
      --gold-soft: #f5e3a1;
      --text-main: #f7f7f7;
      --text-sub: #b3b3b3;
      --danger: #ff6b6b;
      --success: #4cd964;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #1b1b27 0, #050508 55%);
      color: var(--text-main);
      -webkit-font-smoothing: antialiased;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 12px;
    }

    .app {
      width: 100%;
      max-width: 420px;
      height: 100%;
      max-height: 820px;
      border-radius: 24px;
      border: 1px solid rgba(212, 175, 55, 0.5);
      background: radial-gradient(circle at top, #15151f 0, #050508 60%);
      box-shadow: 0 18px 60px rgba(0, 0, 0, 0.7);
      padding: 14px;
      display: flex;
      flex-direction: column;
      position: relative;
      overflow: hidden;
    }

    /* ì ê¸ˆ í™”ë©´ */
    #lock-screen {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #181824 0, #010103 60%);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 50;
    }

    .lock-box {
      width: 90%;
      max-width: 360px;
      padding: 24px 20px 20px;
      border-radius: 20px;
      border: 1px solid rgba(212, 175, 55, 0.7);
      background: linear-gradient(145deg, #07070b, #14141f);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.8);
      text-align: center;
    }

    .lock-title {
      font-size: 1.1rem;
      letter-spacing: 0.05em;
      color: var(--gold-soft);
      margin-bottom: 8px;
    }

    .lock-sub {
      font-size: 0.8rem;
      color: var(--text-sub);
      margin-bottom: 18px;
    }

    .lock-input {
      width: 120px;
      padding: 10px 12px;
      font-size: 1.1rem;
      text-align: center;
      border-radius: 999px;
      border: 1px solid rgba(212, 175, 55, 0.8);
      background: rgba(5, 5, 10, 0.9);
      color: var(--text-main);
      outline: none;
      letter-spacing: 0.2em;
    }

    .lock-input:focus {
      box-shadow: 0 0 0 1px rgba(212, 175, 55, 0.9);
    }

    .lock-btn {
      margin-top: 14px;
      padding: 9px 18px;
      font-size: 0.9rem;
      border-radius: 999px;
      border: none;
      background: linear-gradient(120deg, #f5e3a1, #d4af37);
      color: #111;
      font-weight: 600;
      cursor: pointer;
    }

    .lock-error {
      margin-top: 10px;
      min-height: 18px;
      font-size: 0.78rem;
      color: var(--danger);
    }

    /* í—¤ë” */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 4px 10px;
      border-bottom: 1px solid rgba(212, 175, 55, 0.3);
    }

    .title-wrap {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .title {
      font-size: 0.95rem;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      color: var(--gold-soft);
    }

    .subtitle {
      font-size: 0.8rem;
      color: var(--text-sub);
    }

    .status-wrap {
      text-align: right;
      font-size: 0.75rem;
    }

    .dday {
      color: var(--gold-soft);
      font-weight: 600;
    }

    .remain {
      color: var(--text-sub);
      margin-top: 2px;
    }

    /* ì±… ì˜ì—­ */
    .book-wrap {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding-top: 8px;
      overflow: hidden;
    }

    .book {
      position: relative;
      flex: 1;
      display: flex;
      justify-content: center;
      align-items: center;
      perspective: 1600px;
      overflow: hidden;
    }

    .page-container {
      width: 100%;
      max-width: 360px;
      height: 100%;
      max-height: 600px;
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .page {
      width: 100%;
      height: 100%;
      max-height: 520px;
      border-radius: 18px;
      background: radial-gradient(circle at top, #1c1c27 0, #090910 55%);
      border: 1px solid rgba(212, 175, 55, 0.5);
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.8);
      padding: 14px 14px 12px;
      position: relative;
      transform-origin: left center;
      transition: transform 0.5s ease, box-shadow 0.4s ease;
      display: flex;
      flex-direction: column;
    }

    .page-turn-left {
      animation: turnLeft 0.45s ease forwards;
    }

    .page-turn-right {
      animation: turnRight 0.45s ease forwards;
    }

    @keyframes turnLeft {
      0% { transform: rotateY(0deg); box-shadow: 0 16px 40px rgba(0,0,0,0.8); }
      100% { transform: rotateY(-18deg); box-shadow: 0 12px 26px rgba(0,0,0,0.6); }
    }

    @keyframes turnRight {
      0% { transform: rotateY(0deg); box-shadow: 0 16px 40px rgba(0,0,0,0.8); }
      100% { transform: rotateY(18deg); box-shadow: 0 12px 26px rgba(0,0,0,0.6); }
    }

    /* ì¿ í° ì¹´ë“œ (ì•/ë’¤ í”Œë¦½) */
    .coupon-card {
      position: relative;
      flex: 1;
      transform-style: preserve-3d;
      transition: transform 0.6s ease;
      cursor: pointer;
    }

    .coupon-card.flipped {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      inset: 0;
      backface-visibility: hidden;
      border-radius: 14px;
      background: radial-gradient(circle at top, #1b1b27 0, #08080c 60%);
      border: 1px solid rgba(212, 175, 55, 0.6);
      padding: 16px 16px 12px;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
    }

    .card-back {
      transform: rotateY(180deg);
    }

    .gold-frame {
      flex: 1;
      border-radius: 12px;
      border: 1px solid rgba(212, 175, 55, 0.35);
      padding: 12px 12px 10px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      position: relative;
    }

    .page-top-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .page-index {
      font-size: 0.78rem;
      color: var(--text-sub);
    }

    .page-tag {
      font-size: 0.7rem;
      padding: 2px 8px;
      border-radius: 999px;
      border: 1px solid rgba(212, 175, 55, 0.5);
      color: var(--gold-soft);
    }

    .coupon-title {
      font-size: 1rem;
      font-weight: 600;
      letter-spacing: 0.03em;
      margin-bottom: 4px;
    }

    .coupon-sub {
      font-size: 0.8rem;
      color: var(--text-sub);
      margin-bottom: 6px;
    }

    .chip-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 4px;
    }

    .chip {
      font-size: 0.72rem;
      padding: 3px 8px;
      border-radius: 999px;
      border: 1px solid rgba(212, 175, 55, 0.3);
      color: var(--gold-soft);
    }

    .count-info {
      font-size: 0.78rem;
      margin-top: 6px;
    }

    .count-strong {
      color: var(--gold-soft);
      font-weight: 600;
    }

    .used-info {
      font-size: 0.75rem;
      color: var(--text-sub);
      margin-top: 2px;
    }

    .used-info span {
      color: var(--success);
    }

    .hint {
      font-size: 0.7rem;
      color: var(--text-sub);
      margin-top: 6px;
    }

    .card-footer {
      margin-top: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .btn {
      border-radius: 999px;
      border: 1px solid rgba(212, 175, 55, 0.8);
      background: linear-gradient(120deg, rgba(245, 227, 161, 0.1), rgba(14, 14, 20, 0.9));
      color: var(--gold-soft);
      padding: 7px 12px;
      font-size: 0.8rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 4px;
    }

    .btn-primary {
      background: linear-gradient(120deg, #f5e3a1, #d4af37);
      color: #111;
      font-weight: 600;
      border-color: transparent;
    }

    .btn-small {
      font-size: 0.74rem;
      padding: 5px 10px;
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: default;
    }

    .nav-row {
      margin-top: 8px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .nav-btn {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      border: 1px solid rgba(212, 175, 55, 0.6);
      background: radial-gradient(circle at top, #1c1c27 0, #050508 70%);
      color: var(--gold-soft);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.1rem;
      cursor: pointer;
    }

    .nav-title {
      font-size: 0.78rem;
      color: var(--text-sub);
      text-align: center;
    }

    .nav-title span {
      color: var(--gold-soft);
    }

    /* íŒì—… (ë‚ ì§œ ì…ë ¥) */
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.75);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 40;
    }

    .modal.active {
      display: flex;
    }

    .modal-box {
      width: 90%;
      max-width: 340px;
      background: #07070d;
      border-radius: 16px;
      border: 1px solid rgba(212, 175, 55, 0.6);
      padding: 16px 16px 12px;
    }

    .modal-title {
      font-size: 0.95rem;
      color: var(--gold-soft);
      margin-bottom: 10px;
    }

    .modal-body {
      font-size: 0.78rem;
      color: var(--text-sub);
      margin-bottom: 10px;
    }

    .modal-input {
      width: 100%;
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid rgba(212, 175, 55, 0.6);
      background: #050509;
      color: var(--text-main);
      font-size: 0.85rem;
    }

    .modal-actions {
      margin-top: 12px;
      display: flex;
      justify-content: flex-end;
      gap: 8px;
    }

    .footer-tip {
      margin-top: 8px;
      font-size: 0.7rem;
      color: var(--text-sub);
      text-align: center;
    }

    @media (max-height: 640px) {
      .page {
        max-height: 460px;
      }
      .card-face {
        padding: 12px 12px 10px;
      }
      .gold-frame {
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- ì ê¸ˆ í™”ë©´ -->
  <div id="lock-screen">
    <div class="lock-box">
      <div class="lock-title">ì¿ í°ë¶ ì ê¸ˆ</div>
      <div class="lock-sub">ê³µì£¼ë§Œ ë“¤ì–´ì˜¬ ìˆ˜ ìˆëŠ” ë¹„ë°€ ì¿ í°ë¶ì´ì—ìš” ğŸ’›<br/>ë¹„ë°€ë²ˆí˜¸ 4ìë¦¬ë¥¼ ì…ë ¥í•´ ì£¼ì„¸ìš”.</div>
      <input type="password" maxlength="4" class="lock-input" id="lock-input" autocomplete="off" />
      <div>
        <button class="lock-btn" id="lock-btn">ì…ì¥í•˜ê¸°</button>
      </div>
      <div class="lock-error" id="lock-error"></div>
    </div>
  </div>

  <div class="app">
    <!-- í—¤ë” -->
    <header class="header">
      <div class="title-wrap">
        <div class="title">COUPON BOOK</div>
        <div class="subtitle">íŒŒíŠ¸ë¼ìŠˆê°€ ê³µì£¼ì—ê²Œ ì£¼ëŠ” ì¿ í°ë¶</div>
      </div>
      <div class="status-wrap">
        <div class="dday" id="dday-text">D+0</div>
        <div class="remain" id="remain-text">ë‚¨ì€ ì¿ í° 0ì¥</div>
      </div>
    </header>

    <!-- ì±… / ì¿ í° ì¹´ë“œ -->
    <main class="book-wrap">
      <div class="book">
        <div class="page-container">
          <div class="page" id="page">
            <div class="page-top-meta">
              <div class="page-index" id="page-index">1 / 8</div>
              <div class="page-tag" id="page-tag">ì¿ í°</div>
            </div>
            <div class="coupon-card" id="coupon-card">
              <!-- ì•ë©´ -->
              <div class="card-face card-front">
                <div class="gold-frame">
                  <div>
                    <div class="coupon-title" id="front-title">ì¿ í° ì œëª©</div>
                    <div class="coupon-sub" id="front-sub">ì¿ í° ê°„ë‹¨ ì„¤ëª…</div>
                    <div class="chip-row" id="front-chips"></div>
                    <div class="count-info">
                      ë‚¨ì€ ì¥ ìˆ˜: <span class="count-strong" id="front-remaining">0ì¥</span>
                    </div>
                    <div class="used-info" id="front-used-info"></div>
                  </div>
                  <div class="card-footer">
                    <button class="btn btn-small" id="flip-to-back">ë’·ë©´ ë³´ê¸°</button>
                    <button class="btn btn-primary btn-small" id="use-front">ì‚¬ìš©í•˜ê¸°</button>
                  </div>
                  <div class="hint">ì¹´ë“œë¥¼ íƒ­í•˜ë©´ ì•/ë’¤ê°€ ë’¤ì§‘í˜€ìš”.</div>
                </div>
              </div>

              <!-- ë’·ë©´ -->
              <div class="card-face card-back">
                <div class="gold-frame">
                  <div>
                    <div class="coupon-title" id="back-title">ì¿ í° ìƒì„¸ ë‚´ìš©</div>
                    <div class="coupon-sub" id="back-sub"></div>
                    <div class="used-info" id="back-used-info"></div>
                  </div>
                  <div class="card-footer">
                    <button class="btn btn-small" id="flip-to-front">ì•ë©´ ë³´ê¸°</button>
                    <button class="btn btn-primary btn-small" id="use-back">ì‚¬ìš©í•˜ê¸°</button>
                  </div>
                  <div class="hint">ì‚¬ìš©í•˜ë©´ ë‚ ì§œê°€ ì €ì¥ë˜ê³  ë‚¨ì€ ê°œìˆ˜ê°€ ì¤„ì–´ë“¤ì–´ìš”.</div>
                </div>
              </div>
            </div>

            <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
            <div class="nav-row">
              <button class="nav-btn" id="prev-btn">&#9664;</button>
              <div class="nav-title">
                <span id="nav-title-text">ì¿ í° 1</span><br />
                ì¢Œìš°ë¡œ ë„˜ê¸°ë©´ ë‹¤ë¥¸ ì¿ í°ì„ ë³¼ ìˆ˜ ìˆì–´ìš”.
              </div>
              <button class="nav-btn" id="next-btn">&#9654;</button>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-tip">
        í° ë¸Œë¼ìš°ì € ë©”ë‰´ì—ì„œ â€œí™ˆ í™”ë©´ì— ì¶”ê°€â€ë¥¼ í•˜ë©´ ì•±ì²˜ëŸ¼ ì“¸ ìˆ˜ ìˆì–´ìš”.
      </div>
    </main>
  </div>

  <!-- ë‚ ì§œ ì…ë ¥ ëª¨ë‹¬ -->
  <div class="modal" id="date-modal">
    <div class="modal-box">
      <div class="modal-title" id="modal-title">ì¿ í° ì‚¬ìš©í•˜ê¸°</div>
      <div class="modal-body">
        ì‚¬ìš©í•œ ë‚ ì§œë¥¼ ì ì–´ë‘˜ê²Œìš”. ì˜¤ëŠ˜ ë‚ ì§œ ê·¸ëŒ€ë¡œ ë‘ê±°ë‚˜, ì›í•˜ëŠ” ë‚ ì§œë¡œ ë°”ê¿€ ìˆ˜ ìˆì–´ìš”.
      </div>
      <input type="date" class="modal-input" id="date-input" />
      <div class="modal-actions">
        <button class="btn btn-small" id="cancel-date">ì·¨ì†Œ</button>
        <button class="btn btn-primary btn-small" id="confirm-date">ì €ì¥</button>
      </div>
    </div>
  </div>

  <script>
    // ====== ê¸°ë³¸ ë°ì´í„° ======
    const coupons = [
      {
        id: 1,
        title: "ì›í•˜ëŠ” ë¹µ ë¬´ì—‡ì´ë“  ë¨¹ìœ¼ëŸ¬ ê°€ê¸°",
        short: "ê³µì£¼ê°€ ë¨¹ê³  ì‹¶ì€ ë¹µ ì•„ë¬´ê±°ë‚˜ Â· ê±°ë¦¬Â·ê°€ê²© ì œí•œ ì—†ìŒ",
        tag: "ë°ì´íŠ¸",
        total: 3,
        desc: "ê³µì£¼ê°€ ë¨¹ê³  ì‹¶ì€ ë¹µ, ë””ì €íŠ¸, ë² ì´ì»¤ë¦¬ <br>ì•„ë¬´ ê³³ì´ë‚˜ OK<br>ê±°ë¦¬, ê°€ê²© ì œí•œ ì—†ì´ í•œ ë²ˆ ë§í•˜ë©´ ë°”ë¡œ ë°ë ¤ê°€ê¸°.<br>ê³µì£¼ê°€ 2ê°œ ë¨¹ê³  ì‹¶ë‹¤ í•˜ë©´ 2ê°œë„ ê°€ëŠ¥!",
      },
      {
        id: 2,
        title: "10ë¶„ ë™ì•ˆ ì›í•˜ëŠ” ë§Œí¼ ì•ˆì•„ì£¼ê¸°",
        short: "ë§ ì—†ì´ 10ë¶„ ë™ì•ˆ ê¼­ ê»´ì•ˆì•„ ì£¼ê¸°",
        tag: "ìŠ¤í‚¨ì‹­",
        total: 5,
        desc: "ê³µì£¼ê°€ ë¶™ì¡ê³  ìˆëŠ” ë™ì•ˆ 10ë¶„ ì´ìƒ í¬ì˜¹ ìœ ì§€.<br> ë§ì€ ìµœì†Œí•œìœ¼ë¡œ, ì†ì€ í¸í•˜ê²Œ ì•ˆì•„ì£¼ëŠ” ìš©ë„ë§Œ. <br>ì–¸ì œ ëë‚¼ì§€ëŠ” ê³µì£¼ê°€ ì •í•´ìš”.",
      },
      {
        id: 3,
        title: "ë§ˆì‚¬ì§€ ì¿ í° (ì›í•˜ëŠ” ë¶€ìœ„ 30ë¶„)",
        short: "ì›í•˜ëŠ” ë¶€ìœ„ 1ê³³ 30ë¶„ ì§‘ì¤‘ ë§ˆì‚¬ì§€",
        tag: "ì¼€ì–´",
        total: 10,
        desc: "ì–´ê¹¨, ë“±, í—ˆë¦¬, ë‹¤ë¦¬ ë“± ê³µì£¼ê°€ ì›í•˜ëŠ” ë¶€ìœ„ 1ê³³ ê³¨ë¼ì„œ 30ë¶„ ë™ì•ˆ ì§‘ì¤‘ ë§ˆì‚¬ì§€. <br>ì¤‘ê°„ì— ëŒ€ì¶©í•˜ê¸° ê¸ˆì§€.<br> ê°•ë„ì™€ ì†ë„ëŠ” ê³µì£¼ê°€ ì§€ì‹œí•˜ë©´ ê·¸ëŒ€ë¡œ ë”°ë¥´ê¸°.",
      },
      {
        id: 4,
        title: "ë‹¬ë˜ì£¼ê¸° ì¿ í° (ì´ìœ  ë¬»ì§€ ì•Šê¸°)",
        short: "ì´ìœ  ì ˆëŒ€ ë¬»ì§€ ë§ê³  ëê¹Œì§€ ë‹¬ë˜ì£¼ê¸°",
        tag: "ê°ì • ì¼€ì–´",
        total: 3,
        desc: "ê³µì£¼ê°€ í˜ë“¤ê±°ë‚˜ í† ë¼ì¡Œì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ì¿ í°. <br>â€˜ì™œ ê·¸ë˜?â€™ ê°™ì€ ì§ˆë¬¸ ê¸ˆì§€. <br>ê³µì£¼ê°€ ê´œì°®ì•„ì§ˆ ë•Œê¹Œì§€ ì˜†ì— ìˆì–´ì£¼ê³ , ì•ˆì•„ì£¼ê³ , ë¨¸ë¦¬ ì“°ë‹¤ë“¬ì–´ì£¼ê¸°. ë§íˆ¬ëŠ” ëê¹Œì§€ ë‹¤ì •í•˜ê²Œ.",
      },
      {
        id: 5,
        title: "ë…¸ì˜ˆ ì¿ í° (3ì‹œê°„)",
        short: "3ì‹œê°„ ë™ì•ˆ ê³µì£¼ ì „ìš© ë…¸ì˜ˆ ëª¨ë“œ",
        tag: "ë¯¸ì…˜",
        total: 2,
        desc: "3ì‹œê°„ ë™ì•ˆ ê³µì£¼ê°€ ì‹œí‚¤ëŠ” ì‹¬ë¶€ë¦„, ì§‘ì•ˆì¼, ì¡ì¼ ë“±ì„ ë¶ˆí‰ ì—†ì´ ìˆ˜í–‰. <br>â€˜ê·€ì°®ì•„â€™ ê¸ˆì§€. ë‹¤ë§Œ ì„œë¡œ ìƒì‹ì„ ì—ì„œ ê°€ëŠ¥í•œ ê²ƒë§Œ, <br>ëª¸ì— ë¬´ë¦¬ ë˜ëŠ” ê±´ ì œì™¸.",
      },
      {
        id: 6,
        title: "ì„±ë…¸ì˜ˆ ì¿ í° (1íšŒ)",
        short: "ê³µì£¼ê°€ 1ì¼ ì—¬ì™•ì´ë˜ëŠ” ì¿ í°!",
        tag: "ë¹„ë°€",
        total: 2,
        desc: "ê³µì£¼ê°€ ì›í•˜ëŠ” ì·¨í–¥ê³¼ í•˜ê³ ì‹¶ì€ ëª¨ë“ ê²ƒì„ ë§ˆìŒëŒ€ë¡œ í•  ìˆ˜ìˆìŒ.<br> ìƒí™©ê·¹,ë³µì¥,í•˜ê³ ì‹¶ì€í–‰ìœ„,ì²´ìœ„ ì›í•˜ëŠ”ê±´ ì‹œí‚¤ê¸°ë§Œ í•˜ë©´ ì„±ë…¸ì˜ˆëŠ” ì„±ì‹¤íˆ ìˆ˜í–‰.",
      },
      {
        id: 7,
        title: "ì‹ì‚¬ ì¿ í° (ì›í•˜ëŠ” ìŒì‹ ê°™ì´ ë¨¹ê¸°)",
        short: "ê³µì£¼ê°€ ê³ ë¥¸ ë©”ë‰´ë¡œ í•¨ê»˜ ì‹ì‚¬",
        tag: "ë°ì´íŠ¸",
        total: 3,
        desc: "ê³µì£¼ê°€ ë¨¹ê³  ì‹¶ì€ ë©”ë‰´ë¡œ ì‹ë‹¹ì„ ì •í•˜ë©´, <br>ê±°ë¦¬Â·ê°€ê²© ìƒê´€ì—†ì´ ê°™ì´ ê°€ì„œ ì¦ê²ê²Œ ì‹ì‚¬í•˜ê¸°. <br>ê°€ëŠ¥í•˜ë©´ ë””ì €íŠ¸ê¹Œì§€, ëŒ€í™” ë§ì´ í•˜ê³  í°ì€ ìµœì†Œí•œë§Œ ë³´ê¸°.",
      },
      {
        id: 8,
        title: "ê¸´ê¸‰ ì†Œí™˜ ì¿ í°",
        short: "í•„ìš”í•  ë•Œ ì´ìœ  ë¶ˆë¬¸ ì¦‰ì‹œ ë°ë¦¬ëŸ¬ ì˜¤ê¸°",
        tag: "ë”°ê¹Œë¦¬ ëª¨ë“œ",
        total: 1,
        desc: "ê³µì£¼ê°€ ì—°ë½í•˜ë©´ ê°€ëŠ¥í•œ í•œ ë¹¨ë¦¬ ë°ë¦¬ëŸ¬ ì˜¤ê¸°. <br>ì´ìœ  ë¬»ì§€ ì•Šê³  â€˜ê°ˆê²Œâ€™ë§Œ ë§í•˜ê¸°. <br>ë„ì°© í›„ì—ëŠ” ê³µì£¼ê°€ ì›í•˜ëŠ” ë§Œí¼ ê°™ì´ ìˆì–´ì£¼ê¸°.",
      }
    ];

    // localStorage key
    const STORAGE_KEY = "onyx_coupon_book_v1";

    let state = {
      coupons: {},
      currentIndex: 0
    };

    function initState() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        try {
          state = JSON.parse(saved);
        } catch (e) {
          console.error("state parse error", e);
        }
      }

      // ìµœì´ˆ ì„¸íŒ…
      if (!state.coupons || Object.keys(state.coupons).length === 0) {
        state.coupons = {};
        coupons.forEach((c, idx) => {
          state.coupons[c.id] = {
            remaining: c.total,
            usedDates: []
          };
        });
      }

      if (typeof state.currentIndex !== "number") {
        state.currentIndex = 0;
      }
    }

    function saveState() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
    }

    // D-day ê³„ì‚°
    function updateDDay() {
      const start = new Date(2024, 8, 18); // 2024-09-18 (month 0ë¶€í„° ì‹œì‘)
      const today = new Date();
      const diff = Math.floor((today - start) / (1000 * 60 * 60 * 24));
      const ddayText = document.getElementById("dday-text");
      ddayText.textContent = `D+${diff}`;
    }

    function getTotalRemaining() {
      return coupons.reduce((sum, c) => {
        const st = state.coupons[c.id];
        return sum + (st ? st.remaining : 0);
      }, 0);
    }

    function updateRemainText() {
      const remainEl = document.getElementById("remain-text");
      const total = getTotalRemaining();
      remainEl.textContent = `ë‚¨ì€ ì¿ í° ${total}ì¥`;
    }

    // í™”ë©´ ë Œë”ë§
    function renderCoupon() {
      const idx = state.currentIndex;
      const coupon = coupons[idx];
      const st = state.coupons[coupon.id];

      const pageIndexEl = document.getElementById("page-index");
      const navTitleTextEl = document.getElementById("nav-title-text");
      const pageTagEl = document.getElementById("page-tag");

      pageIndexEl.textContent = `${idx + 1} / ${coupons.length}`;
      navTitleTextEl.textContent = coupon.title;
      pageTagEl.textContent = coupon.tag || "ì¿ í°";

      const card = document.getElementById("coupon-card");
      card.classList.remove("flipped");

      // ì•ë©´
      document.getElementById("front-title").textContent = coupon.title;
      document.getElementById("front-sub").textContent = coupon.short;
      const chipsWrap = document.getElementById("front-chips");
      chipsWrap.innerHTML = "";
      const chip1 = document.createElement("div");
      chip1.className = "chip";
      chip1.textContent = coupon.tag;
      chipsWrap.appendChild(chip1);

      const chip2 = document.createElement("div");
      chip2.className = "chip";
      chip2.textContent = `ì´ ${coupon.total}ì¥ ì¤‘`;
      chipsWrap.appendChild(chip2);

      document.getElementById("front-remaining").textContent = `${st.remaining}ì¥`;

      const usedInfoFront = document.getElementById("front-used-info");
      if (st.usedDates && st.usedDates.length > 0) {
        const last = st.usedDates[st.usedDates.length - 1];
        usedInfoFront.innerHTML = `ë§ˆì§€ë§‰ ì‚¬ìš©ì¼: <span>${last}</span> (ì´ ${st.usedDates.length}íšŒ ì‚¬ìš©)`;
      } else {
        usedInfoFront.textContent = "ì•„ì§ í•œ ë²ˆë„ ì‚¬ìš©í•˜ì§€ ì•Šì•˜ì–´ìš”.";
      }

      // ë’·ë©´
      document.getElementById("back-title").textContent = coupon.title;
document.getElementById("back-sub").innerHTML = coupon.desc.replace(/\n/g, "<br>");
      const usedInfoBack = document.getElementById("back-used-info");
      if (st.usedDates && st.usedDates.length > 0) {
        const last = st.usedDates[st.usedDates.length - 1];
        usedInfoBack.innerHTML = `ìµœê·¼ ì‚¬ìš©ì¼: <span>${last}</span><br/>ì§€ê¸ˆê¹Œì§€ ${st.usedDates.length}ë²ˆ ì‚¬ìš©í–ˆì–´ìš”.`;
      } else {
        usedInfoBack.textContent = "ì•„ì§ ì‚¬ìš©í•˜ì§€ ì•Šì€ ìƒˆ ì¿ í°ì´ì—ìš”.";
      }

      // ë²„íŠ¼ ìƒíƒœ
      const useFrontBtn = document.getElementById("use-front");
      const useBackBtn = document.getElementById("use-back");
      const disabled = st.remaining <= 0;
      useFrontBtn.disabled = disabled;
      useBackBtn.disabled = disabled;
    }

    // í˜ì´ì§€ ë„˜ê¹€ ì• ë‹ˆë©”ì´ì…˜
    function turnPage(direction) {
      const pageEl = document.getElementById("page");
      if (!pageEl) return;
      pageEl.classList.remove("page-turn-left", "page-turn-right");
      if (direction === "next") {
        pageEl.classList.add("page-turn-right");
      } else {
        pageEl.classList.add("page-turn-left");
      }

      setTimeout(() => {
        pageEl.classList.remove("page-turn-left", "page-turn-right");
      }, 450);
    }

    // ì¿ í° ì‚¬ìš© ì²˜ë¦¬
    let modalCouponId = null;

    function openDateModal(couponId) {
      modalCouponId = couponId;
      const modal = document.getElementById("date-modal");
      const input = document.getElementById("date-input");
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, "0");
      const dd = String(today.getDate()).padStart(2, "0");
      input.value = `${yyyy}-${mm}-${dd}`;
      modal.classList.add("active");
    }

    function closeDateModal() {
      modalCouponId = null;
      const modal = document.getElementById("date-modal");
      modal.classList.remove("active");
    }

    function confirmDate() {
      if (!modalCouponId) {
        closeDateModal();
        return;
      }
      const input = document.getElementById("date-input");
      const value = input.value;
      if (!value) {
        closeDateModal();
        return;
      }
      const couponId = modalCouponId;
      const st = state.coupons[couponId];
      if (!st || st.remaining <= 0) {
        closeDateModal();
        return;
      }
      st.remaining -= 1;
      st.usedDates = st.usedDates || [];
      st.usedDates.push(value.replace(/-/g, "."));
      saveState();
      closeDateModal();
      updateRemainText();
      renderCoupon();
    }

    // ì ê¸ˆ
    function setupLockScreen() {
      const lockInput = document.getElementById("lock-input");
      const lockBtn = document.getElementById("lock-btn");
      const lockError = document.getElementById("lock-error");
      const lockScreen = document.getElementById("lock-screen");

      function unlock() {
        const v = lockInput.value.trim();
        if (v === "0918") {
          lockScreen.style.display = "none";
        } else {
          lockError.textContent = "ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ì–´ìš”. ë‹¤ì‹œ í•œ ë²ˆ ì…ë ¥í•´ ì£¼ì„¸ìš”.";
          lockInput.value = "";
        }
      }

      lockBtn.addEventListener("click", unlock);
      lockInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") {
          unlock();
        }
      });
    }

    // ì´ë²¤íŠ¸ ì—°ê²°
    function setupEvents() {
      const prevBtn = document.getElementById("prev-btn");
      const nextBtn = document.getElementById("next-btn");
      const card = document.getElementById("coupon-card");
      const flipToBack = document.getElementById("flip-to-back");
      const flipToFront = document.getElementById("flip-to-front");
      const useFrontBtn = document.getElementById("use-front");
      const useBackBtn = document.getElementById("use-back");

      prevBtn.addEventListener("click", () => {
        if (state.currentIndex > 0) {
          state.currentIndex -= 1;
        } else {
          state.currentIndex = coupons.length - 1;
        }
        saveState();
        turnPage("prev");
        setTimeout(renderCoupon, 120);
      });

      nextBtn.addEventListener("click", () => {
        if (state.currentIndex < coupons.length - 1) {
          state.currentIndex += 1;
        } else {
          state.currentIndex = 0;
        }
        saveState();
        turnPage("next");
        setTimeout(renderCoupon, 120);
      });

      card.addEventListener("click", (e) => {
        // ë²„íŠ¼ í´ë¦­ì€ ë¬´ì‹œ
        if (e.target.tagName.toLowerCase() === "button") return;
        card.classList.toggle("flipped");
      });

      flipToBack.addEventListener("click", (e) => {
        e.stopPropagation();
        card.classList.add("flipped");
      });

      flipToFront.addEventListener("click", (e) => {
        e.stopPropagation();
        card.classList.remove("flipped");
      });

      useFrontBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        const coupon = coupons[state.currentIndex];
        openDateModal(coupon.id);
      });

      useBackBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        const coupon = coupons[state.currentIndex];
        openDateModal(coupon.id);
      });

      document.getElementById("cancel-date").addEventListener("click", closeDateModal);
      document.getElementById("confirm-date").addEventListener("click", confirmDate);
    }

    // ì´ˆê¸°í™”
    document.addEventListener("DOMContentLoaded", () => {
      initState();
      setupLockScreen();
      setupEvents();
      updateDDay();
      updateRemainText();
      renderCoupon();
    });
  </script>
</body>
</html>
